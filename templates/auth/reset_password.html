{% extends 'base.html' %}
{% block title %}Reset Password â€” PhishShield AI{% endblock %}

{% block content %}
<div style="min-height:calc(100vh - 64px); display:flex; align-items:center; justify-content:center; padding:2rem 1rem;">
  <div style="width:100%; max-width:420px;">
    <div class="text-center animate-in" style="margin-bottom:1.75rem;">
      <div style="display:inline-flex; align-items:center; justify-content:center; width:64px; height:64px; border-radius:18px; background:rgba(0,217,255,0.08); border:1px solid rgba(0,217,255,0.25); margin-bottom:1rem; box-shadow:0 0 30px rgba(0,217,255,0.15);">
        <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#00D9FF" stroke-width="2" style="filter:drop-shadow(0 0 8px rgba(0,217,255,0.7))">
          <path d="M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"/>
        </svg>
      </div>
      <h1 style="font-size:1.6rem; font-weight:800; letter-spacing:-0.02em;">
        New <span style="color:var(--neon-blue);">Password</span>
      </h1>
      <p class="text-muted" style="font-size:0.875rem; margin-top:0.4rem;">Choose a strong password for your account</p>
    </div>

    <div class="card card-glow animate-in-delay-1" style="border-color:rgba(0,217,255,0.15);">
      <form method="POST" action="{{ url_for('auth.reset_password', token=token) }}">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />

        <div class="form-group">
          <label class="form-label" for="password">New Password</label>
          <div class="input-wrapper">
            <span class="input-icon">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="11" width="18" height="11" rx="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
            </span>
            <input type="password" class="form-control" id="password" name="password"
                   placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required autocomplete="new-password"
                   oninput="updateStrength(this.value)" />
          </div>
          <div style="margin-top:0.5rem;">
            <div style="height:4px; background:rgba(255,255,255,0.08); border-radius:2px; overflow:hidden;">
              <div id="strength-bar" style="height:100%;width:0%;border-radius:2px;transition:all 0.4s;"></div>
            </div>
            <p id="strength-label" style="font-size:0.75rem;margin-top:0.3rem;color:var(--text-muted);"></p>
          </div>
        </div>

        <div class="form-group">
          <label class="form-label" for="confirm_password">Confirm Password</label>
          <div class="input-wrapper">
            <span class="input-icon">
              <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/></svg>
            </span>
            <input type="password" class="form-control" id="confirm_password" name="confirm_password"
                   placeholder="â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢" required autocomplete="new-password" />
          </div>
        </div>

        <button type="submit" class="btn btn-primary btn-block">
          <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="20 6 9 17 4 12"/></svg>
          Reset Password
        </button>
      </form>
    </div>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script>
function updateStrength(pw) {
  const bar = document.getElementById('strength-bar');
  const label = document.getElementById('strength-label');
  let score = 0;
  if (pw.length >= 8) score++;
  if (/[A-Z]/.test(pw)) score++;
  if (/[a-z]/.test(pw)) score++;
  if (/\d/.test(pw)) score++;
  if (/[!@#$%^&*(),.?":{}|<>]/.test(pw)) score++;
  const levels = [
    {w:'0%',c:'transparent',t:''},
    {w:'20%',c:'#FF4444',t:'Very Weak'},
    {w:'40%',c:'#FF8C00',t:'Weak'},
    {w:'60%',c:'#FFD700',t:'Fair'},
    {w:'80%',c:'#00BFFF',t:'Strong'},
    {w:'100%',c:'#39FF14',t:'Very Strong ðŸ’ª'},
  ];
  bar.style.width = levels[score].w;
  bar.style.background = levels[score].c;
  label.textContent = levels[score].t;
  label.style.color = levels[score].c;
}
</script>
{% endblock %}
